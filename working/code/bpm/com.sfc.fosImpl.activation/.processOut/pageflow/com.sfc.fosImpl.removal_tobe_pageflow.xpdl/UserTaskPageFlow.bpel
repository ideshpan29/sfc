<?xml version="1.0" encoding="UTF-8"?>
<bpws:process exitOnStandardFault="no" name="UserTaskPageFlow"
    suppressJoinFailure="yes" tibex:bxVersion="1.15.0"
    tibex:explicitCompensation="yes"
    tibex:xpdlId="_p7fOoN_CEeec4K-r6PSjHg"
    xmlns:bpws="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
    xmlns:tibex="http://www.tibco.com/bpel/2007/extensions" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <tibex:VariableDescriptor type="PersistentBatching">
        <task name="_BX_SPInput_InsertComment">
            <startingVariables>
                <variable>TaskName</variable>
                <variable>CommentText</variable>
                <variable>Provisioning_Data</variable>
            </startingVariables>
        </task>
        <task name="InsertBusinessData">
            <ProcessManagerScript type="Initiate">
                <variable>TaskName</variable>
                <variable>TechnicalInfo</variable>
            </ProcessManagerScript>
        </task>
        <task name="ContractorMobileTask">
            <startingVariables>
                <variable>TaskName</variable>
                <variable>SelectedContractorGroup</variable>
                <variable>Provisioning_Data</variable>
                <variable>CommentText</variable>
                <variable>SelectedContractor</variable>
                <variable>ContractorNames</variable>
                <variable>TechnicalInfo</variable>
                <variable>CommentHistory</variable>
                <variable>xDMSURL</variable>
                <variable>GroupNames</variable>
            </startingVariables>
        </task>
        <task name="_BX_SPInput_InsertBusinessData">
            <startingVariables>
                <variable>Provisioning_Data</variable>
                <variable>TechnicalInfo</variable>
            </startingVariables>
        </task>
        <task name="LookupData">
            <startingVariables>
                <variable>Provisioning_Data</variable>
                <variable>TechnicalInfo</variable>
            </startingVariables>
        </task>
        <task name="StartEvent">
            <ProcessManagerScript type="Complete">
                <variable>GrpNames</variable>
                <variable>infoLoggerFlag</variable>
                <variable>TaskName</variable>
                <variable>Provisioning_Data</variable>
                <variable>CtrMobileTaskDecision</variable>
                <variable>CommentDataSet</variable>
                <variable>CommentHistory</variable>
                <variable>PM_List</variable>
            </ProcessManagerScript>
        </task>
        <task name="ConfirmDetails">
            <startingVariables>
                <variable>SelectedPM</variable>
                <variable>mgmtIPFlag</variable>
                <variable>Provisioning_Data</variable>
                <variable>SelectedContractor</variable>
                <variable>ContractorNames</variable>
                <variable>FolderID</variable>
                <variable>TechnicalInfo</variable>
                <variable>UID</variable>
                <variable>xDMSURL</variable>
                <variable>PM_List</variable>
                <variable>EquipmentArray</variable>
                <variable>GrpNames</variable>
                <variable>TechnologyArray</variable>
                <variable>TaskName</variable>
                <variable>AccountTypeArray</variable>
                <variable>BuildingIDArray</variable>
                <variable>SelectedContractorGroup</variable>
                <variable>CommentText</variable>
                <variable>equipmentFlag</variable>
                <variable>ServiceTypeArray</variable>
                <variable>CommentHistory</variable>
                <variable>ServiceStatusArray</variable>
                <variable>BandwidthArray</variable>
                <variable>GroupNames</variable>
                <variable>BuildingFloorArray</variable>
            </startingVariables>
            <ProcessManagerScript type="Complete">
                <variable>SelectedPM</variable>
                <variable>infoLoggerFlag</variable>
                <variable>TaskName</variable>
                <variable>SelectedContractorGroup</variable>
            </ProcessManagerScript>
            <ProcessManagerScript type="Initiate">
                <variable>infoLoggerFlag</variable>
                <variable>TaskName</variable>
                <variable>CtrGroups_List</variable>
                <variable>PM_List</variable>
            </ProcessManagerScript>
        </task>
        <task name="ScriptTask">
            <startingVariables>
                <variable>LookupDataServiceStatusRef</variable>
                <variable>LookupDataAccountTypeRef</variable>
                <variable>LookupDataBandwidthRef</variable>
                <variable>LookupDataBuildingIDRef</variable>
                <variable>EquipmentArray</variable>
                <variable>TechnologyArray</variable>
                <variable>LookupDataServiceTypeRef</variable>
                <variable>LookupDataEquipmentTypeRef</variable>
                <variable>AccountTypeArray</variable>
                <variable>BuildingIDArray</variable>
                <variable>LookupDataTechnologyRef</variable>
                <variable>ServiceTypeArray</variable>
                <variable>ServiceStatusArray</variable>
                <variable>BandwidthArray</variable>
                <variable>LookupDataFloorRef</variable>
            </startingVariables>
        </task>
    </tibex:VariableDescriptor>
    <bpws:documentation>*** Generated by TIBCO Business Studio.</bpws:documentation>
    <bpws:variables>
        <bpws:variable name="Provisioning_Data"
            tibex:class="com.sfc.fosImpl.dataModel.ProvisioningDataModel"
            tibex:parameter="inout" tibex:xpdlId="_lj7GkN_EEeec4K-r6PSjHg"/>
        <bpws:variable name="TechnicalInfo"
            tibex:class="com.sfc.fosImpl.dataModel.TechnicalInformation"
            tibex:parameter="inout" tibex:xpdlId="_B5SCMOOtEeeI1KWnGZEQgA"/>
        <bpws:variable name="TaskName" tibex:parameter="inout"
            tibex:xpdlId="_yiVywOO_EeeYfI0_sV0YAA" type="xsd:string"/>
        <bpws:variable name="Mail" tibex:parameter="inout"
            tibex:xpdlId="_RHxX4OYZEeep9dkvO_z3LA" type="xsd:string"/>
        <bpws:variable name="GroupNames" tibex:array="yes"
            tibex:parameter="inout"
            tibex:xpdlId="_Ni4kEPEKEee5fIpJptHEZA" type="xsd:string"/>
        <bpws:variable name="SelectedContractorGroup"
            tibex:parameter="inout"
            tibex:xpdlId="_8EQNMPENEeeJiLkPq4yokA" type="xsd:string"/>
        <bpws:variable name="SelectedContractor" tibex:parameter="inout"
            tibex:xpdlId="_5uqrgPExEeeMCZGsP3rsrw" type="xsd:string"/>
        <bpws:variable name="ContractorNames" tibex:array="yes"
            tibex:parameter="inout"
            tibex:xpdlId="_oC8T0PE1EeeMCZGsP3rsrw" type="xsd:string"/>
        <bpws:variable name="CommentHistory" tibex:array="yes"
            tibex:class="com.sfc.fosImpl.dataModel.CommentData"
            tibex:parameter="inout" tibex:xpdlId="_-MbHoPRPEeeMCZGsP3rsrw"/>
        <bpws:variable name="CommentText" tibex:parameter="inout"
            tibex:xpdlId="_cbofIPR6Eeez78ayMGlX3w" type="xsd:string"/>
        <bpws:variable name="EscalationEmail" tibex:parameter="inout"
            tibex:xpdlId="_CNJI0PUFEeeywP4RjejZPQ" type="xsd:string"/>
        <bpws:variable name="commentDataCase"
            tibex:class="com.sfc.fosImpl.dataModel.CommentDataCase"
            tibex:parameter="inout" tibex:xpdlId="_ZJBQwPacEee_OvMSeNQu6A"/>
        <bpws:variable name="CommentDataSet" tibex:array="yes"
            tibex:classRef="com.sfc.fosImpl.dataModel.CommentDataCase"
            tibex:parameter="inout" tibex:xpdlId="_mN798PavEeeVceMtR_75Ng"/>
        <bpws:variable name="commentDataCaseRef"
            tibex:classRef="com.sfc.fosImpl.dataModel.CommentDataCase"
            tibex:parameter="inout" tibex:xpdlId="_kf1YAfacEee_OvMSeNQu6A"/>
        <bpws:variable name="SelectedPM" tibex:parameter="inout"
            tibex:xpdlId="_ZLtykBB-EeiTfu82n897bg" type="xsd:string"/>
        <bpws:variable name="mgmtIPFlag" tibex:parameter="inout"
            tibex:xpdlId="_7_cSEBRhEeiI4LtXlpi0-g" type="xsd:boolean"/>
        <bpws:variable name="equipmentFlag" tibex:parameter="inout"
            tibex:xpdlId="_9WKNYBRhEeiI4LtXlpi0-g" type="xsd:boolean"/>
        <bpws:variable name="UID" tibex:parameter="inout"
            tibex:xpdlId="_1bmpMBUzEeiHR83Su52TNA" type="xsd:string"/>
        <bpws:variable name="FolderID" tibex:parameter="inout"
            tibex:xpdlId="_4qOhUBUzEeiHR83Su52TNA" type="xsd:string"/>
        <bpws:variable name="xDMSURL" tibex:parameter="inout"
            tibex:xpdlId="_5VCY4BUzEeiHR83Su52TNA" type="xsd:string"/>
        <bpws:variable name="AccountType" tibex:array="yes"
            tibex:xpdlId="_PNS9kPt1EeeupNwu8S8N4Q" type="xsd:string"/>
        <bpws:variable name="AccountEntries"
            tibex:classRef="com.sfc.fosImpl.dataModel.LookupTable" tibex:xpdlId="_ej8-gft1EeeupNwu8S8N4Q"/>
        <bpws:variable name="SystemParamRef"
            tibex:classRef="com.sfc.fosImpl.dataModel.SystemParameters" tibex:xpdlId="_Sc-sEAlfEeiPXa3e9UY2HA"/>
        <bpws:variable name="CtrMobileTaskDecision"
            tibex:xpdlId="_ZwCC8AlfEeiPXa3e9UY2HA" type="xsd:boolean"/>
        <bpws:variable name="infoLoggerFlag"
            tibex:xpdlId="_9TAXsBPdEeiI4LtXlpi0-g" type="xsd:boolean"/>
        <bpws:variable name="PM_List" tibex:array="yes"
            tibex:xpdlId="_1Xb9YBPfEeiI4LtXlpi0-g" type="xsd:string"/>
        <bpws:variable name="CtrGroups_List" tibex:array="yes"
            tibex:xpdlId="_cY6fUBRYEeiI4LtXlpi0-g" type="xsd:string"/>
        <bpws:variable name="GrpNames" tibex:array="yes"
            tibex:xpdlId="_HiVqUBReEeiI4LtXlpi0-g" type="xsd:string"/>
        <bpws:variable name="Technical_InformationRef"
            tibex:classRef="com.sfc.fosImpl.bizData.dataModel.Technical_Information" tibex:xpdlId="_fVRekBbQEei5zJcabt9kCg"/>
        <bpws:variable name="LookupDataAccountTypeRef" tibex:array="yes"
            tibex:classRef="com.sfc.fosImpl.dataModel.LookupTable" tibex:xpdlId="_V04-wCNYEeiHXsndwsqKDg"/>
        <bpws:variable name="AccountTypeArray" tibex:array="yes"
            tibex:xpdlId="_W0ygESNZEeiHXsndwsqKDg" type="xsd:string"/>
        <bpws:variable name="LookupDataServiceTypeRef" tibex:array="yes"
            tibex:classRef="com.sfc.fosImpl.dataModel.LookupTable" tibex:xpdlId="_pxT_ACNaEeiHXsndwsqKDg"/>
        <bpws:variable name="ServiceTypeArray" tibex:array="yes"
            tibex:xpdlId="_uxbC4CNaEeiHXsndwsqKDg" type="xsd:string"/>
        <bpws:variable name="LookupDataBandwidthRef" tibex:array="yes"
            tibex:classRef="com.sfc.fosImpl.dataModel.LookupTable" tibex:xpdlId="_lKVdwCNjEeiHXsndwsqKDg"/>
        <bpws:variable name="BandwidthArray" tibex:array="yes"
            tibex:xpdlId="_ojr_MCNjEeiHXsndwsqKDg" type="xsd:string"/>
        <bpws:variable name="LookupDataServiceStatusRef"
            tibex:array="yes"
            tibex:classRef="com.sfc.fosImpl.dataModel.LookupTable" tibex:xpdlId="_NG2aICNkEeiHXsndwsqKDg"/>
        <bpws:variable name="ServiceStatusArray" tibex:array="yes"
            tibex:xpdlId="_RhR-ECNkEeiHXsndwsqKDg" type="xsd:string"/>
        <bpws:variable name="LookupDataTechnologyRef" tibex:array="yes"
            tibex:classRef="com.sfc.fosImpl.dataModel.LookupTable" tibex:xpdlId="_ZWY5ICNkEeiHXsndwsqKDg"/>
        <bpws:variable name="TechnologyArray" tibex:array="yes"
            tibex:xpdlId="_dZjMkCNkEeiHXsndwsqKDg" type="xsd:string"/>
        <bpws:variable name="LookupDataEquipmentTypeRef"
            tibex:array="yes"
            tibex:classRef="com.sfc.fosImpl.dataModel.LookupTable" tibex:xpdlId="_3nnb8CNkEeiHXsndwsqKDg"/>
        <bpws:variable name="EquipmentArray" tibex:array="yes"
            tibex:xpdlId="_CDrLICNlEeiHXsndwsqKDg" type="xsd:string"/>
        <bpws:variable name="LookupDataBuildingIDRef" tibex:array="yes"
            tibex:classRef="com.sfc.fosImpl.dataModel.LookupTable" tibex:xpdlId="_UtMMgCN8EeiHXsndwsqKDg"/>
        <bpws:variable name="BuildingIDArray" tibex:array="yes"
            tibex:xpdlId="_a7fh0SN8EeiHXsndwsqKDg" type="xsd:string"/>
        <bpws:variable name="LookupDataFloorRef" tibex:array="yes"
            tibex:classRef="com.sfc.fosImpl.dataModel.LookupTable" tibex:xpdlId="_nC3jUSN8EeiHXsndwsqKDg"/>
        <bpws:variable name="BuildingFloorArray" tibex:array="yes"
            tibex:xpdlId="_BcZb0CN9EeiHXsndwsqKDg" type="xsd:string"/>
    </bpws:variables>
    <bpws:extensions>
        <bpws:extension mustUnderstand="yes" namespace="http://www.tibco.com/bpel/2007/extensions"/>
    </bpws:extensions>
    <bpws:eventHandlers/>
    <bpws:flow name="_BX_flow_SpZXgCXnEeiVIr-c0HRmlw">
        <bpws:links>
            <bpws:link name="ConfirmDetails to InsertBusinessData" tibex:xpdlId="_aAvNYBbREei5zJcabt9kCg"/>
            <bpws:link name="ScriptTask to _iwMb4AlfEeiPXa3e9UY2HA" tibex:xpdlId="_iwMb4QlfEeiPXa3e9UY2HA"/>
            <bpws:link name="InsertComment to EndEvent2" tibex:xpdlId="_ZbU7kBbDEei_483sJGVYzg"/>
            <bpws:link name="InsertBusinessData to InsertComment" tibex:xpdlId="_eybawBbREei5zJcabt9kCg"/>
            <bpws:link name="LookupData to ScriptTask" tibex:xpdlId="_BKrZgCNYEeiHXsndwsqKDg"/>
            <bpws:link name="ContractorMobileTask to InsertBusinessData" tibex:xpdlId="_bUD2cBbREei5zJcabt9kCg"/>
            <bpws:link name="_iwMb4AlfEeiPXa3e9UY2HA to ConfirmDetails" tibex:xpdlId="_5nGy8N_CEeec4K-r6PSjHg"/>
            <bpws:link
                name="_iwMb4AlfEeiPXa3e9UY2HA to ContractorMobileTask" tibex:xpdlId="_joofwAlfEeiPXa3e9UY2HA"/>
            <bpws:link name="StartEvent to LookupData" tibex:xpdlId="_XtaVUBbQEei5zJcabt9kCg"/>
        </bpws:links>
        <bpws:extensionActivity>
            <tibex:receiveEvent createInstance="yes" eventTimeout="0"
                name="StartEvent" tibex:type="startEvent"
                tibex:xpdlId="_tHTqYt_CEeec4K-r6PSjHg" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:sources>
                    <bpws:source linkName="StartEvent to LookupData"/>
                </bpws:sources>
                <tibex:completedScript expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[var  provInfoLogging = cac_com_sfc_fosImpl_dataModel_SystemParameters.findByPropertyName("PROVISIONING_INFO_LOGGING");
if((provInfoLogging !=null) && (provInfoLogging.readSystemParameters() !=null)){
	if(provInfoLogging.readSystemParameters().propertyValue=="Y") {
		infoLoggerFlag=true;
	}
	else {
		infoLoggerFlag=false;
	}
}

if(TaskName=="GateKeeper") {
	var PMList=Process.getOrgModel().groupByName("PM").get(0).getResources();
	if(infoLoggerFlag==true) {
		Log.write("[SFC_FOSIMPL_BPM] UserTaskPageFLow_Complete_Script_Start_Event_PM_Performer : "+PMList.size());
	}
	for(var i=0;i<PMList.size();i++) {
		if(infoLoggerFlag==true) {
			Log.write("[SFC_FOSIMPL_BPM] UserTaskPageFlow_Complete_Script_Start_Event_getName : "+PMList.get(i).getName());
		}	
		PM_List.add(PMList.get(i).getName());	
	}
}
else if(TaskName == "PM_Track_Installation") {
	var criteria = "masterUser='Y'";	
	var Fetch_Groups=cac_com_sfc_fosImpl_dataModel_ContractorGroups.findByCriteria(criteria);
	for(var i=0;i<Fetch_Groups.size();i++) {	
		GrpNames.add(i,Fetch_Groups.get(i).readContractorGroups().contractorGroupName);
	}
}


CtrMobileTaskDecision=false;

var criteria = "siebelCircuitID='"+Provisioning_Data.siebelCircuitID+"'";
CommentDataSet=cac_com_sfc_fosImpl_dataModel_CommentDataCase.findByCriteria(criteria);

CommentHistory.clear();
if(CommentDataSet.size()>0){
	for(var index=0; index<CommentDataSet.size(); index++) {
		var comment=com_sfc_fosImpl_dataModel_Factory.createCommentData();
		comment.addedby=CommentDataSet.get(index).readCommentDataCase().addedby;
		comment.comments=CommentDataSet.get(index).readCommentDataCase().comments;
		comment.stepName=CommentDataSet.get(index).readCommentDataCase().taskName;
		comment.time=CommentDataSet.get(index).readCommentDataCase().time;
		CommentHistory.add(comment);	
	}
}
]]></tibex:completedScript>
                <tibex:parameters>
                    <parameterDescription mode="InOut" name="SelectedPM"/>
                    <parameterDescription mode="InOut" name="mgmtIPFlag"/>
                    <parameterDescription mode="InOut" name="Provisioning_Data"/>
                    <parameterDescription mode="InOut" name="SelectedContractor"/>
                    <parameterDescription mode="InOut" name="ContractorNames"/>
                    <parameterDescription mode="InOut" name="TechnicalInfo"/>
                    <parameterDescription mode="InOut" name="Mail"/>
                    <parameterDescription mode="InOut" name="FolderID"/>
                    <parameterDescription mode="InOut" name="UID"/>
                    <parameterDescription mode="InOut" name="CommentDataSet"/>
                    <parameterDescription mode="InOut" name="xDMSURL"/>
                    <parameterDescription mode="InOut" name="EscalationEmail"/>
                    <parameterDescription mode="InOut" name="commentDataCase"/>
                    <parameterDescription mode="InOut" name="TaskName"/>
                    <parameterDescription mode="InOut" name="SelectedContractorGroup"/>
                    <parameterDescription mode="InOut" name="equipmentFlag"/>
                    <parameterDescription mode="InOut" name="CommentText"/>
                    <parameterDescription mode="InOut" name="CommentHistory"/>
                    <parameterDescription mode="InOut" name="GroupNames"/>
                    <parameterDescription mode="InOut" name="commentDataCaseRef"/>
                </tibex:parameters>
                <tibex:completedScript
                    expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions"><![CDATA[var  provInfoLogging = cac_com_sfc_fosImpl_dataModel_SystemParameters.findByPropertyName("PROVISIONING_INFO_LOGGING");
if((provInfoLogging !=null) && (provInfoLogging.readSystemParameters() !=null)){
	if(provInfoLogging.readSystemParameters().propertyValue=="Y") {
		infoLoggerFlag=true;
	}
	else {
		infoLoggerFlag=false;
	}
}

if(TaskName=="GateKeeper") {
	var PMList=Process.getOrgModel().groupByName("PM").get(0).getResources();
	if(infoLoggerFlag==true) {
		Log.write("[SFC_FOSIMPL_BPM] UserTaskPageFLow_Complete_Script_Start_Event_PM_Performer : "+PMList.size());
	}
	for(var i=0;i<PMList.size();i++) {
		if(infoLoggerFlag==true) {
			Log.write("[SFC_FOSIMPL_BPM] UserTaskPageFlow_Complete_Script_Start_Event_getName : "+PMList.get(i).getName());
		}	
		PM_List.add(PMList.get(i).getName());	
	}
}
else if(TaskName == "PM_Track_Installation") {
	var criteria = "masterUser='Y'";	
	var Fetch_Groups=cac_com_sfc_fosImpl_dataModel_ContractorGroups.findByCriteria(criteria);
	for(var i=0;i<Fetch_Groups.size();i++) {	
		GrpNames.add(i,Fetch_Groups.get(i).readContractorGroups().contractorGroupName);
	}
}


CtrMobileTaskDecision=false;

var criteria = "siebelCircuitID='"+Provisioning_Data.siebelCircuitID+"'";
CommentDataSet=cac_com_sfc_fosImpl_dataModel_CommentDataCase.findByCriteria(criteria);

CommentHistory.clear();
if(CommentDataSet.size()>0){
	for(var index=0; index<CommentDataSet.size(); index++) {
		var comment=com_sfc_fosImpl_dataModel_Factory.createCommentData();
		comment.addedby=CommentDataSet.get(index).readCommentDataCase().addedby;
		comment.comments=CommentDataSet.get(index).readCommentDataCase().comments;
		comment.stepName=CommentDataSet.get(index).readCommentDataCase().taskName;
		comment.time=CommentDataSet.get(index).readCommentDataCase().time;
		CommentHistory.add(comment);	
	}
}
]]></tibex:completedScript>
                <tibex:eventSource>
                    <tibex:startEvent eventType="Default"/>
                </tibex:eventSource>
            </tibex:receiveEvent>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="ConfirmDetails"
                tibex:extendedAttributes="bpmJspTask=form\://comsfcfosImplremoval_tobe_pageflow/comsfcfosImplremoval_tobe_pageflowProcess/ConfirmDetails/GatekeeperApproval.form&#xd;&#xa;"
                tibex:type="userTask"
                tibex:xpdlId="_7fQnYN_CEeec4K-r6PSjHg" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="_iwMb4AlfEeiPXa3e9UY2HA to ConfirmDetails"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="ConfirmDetails to InsertBusinessData"/>
                </bpws:sources>
                <model:PageActivityDataModelType xmi:version="2.0"
                    xmlns:model="http://model.pageactivity.n2.tibco.com" xmlns:xmi="http://www.omg.org/XMI">
                    <pageActivityParameters>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="Provisioning_Data"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="TechnicalInfo"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="TaskName"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="GroupNames"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="SelectedContractorGroup"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="SelectedContractor"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="ContractorNames"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="CommentText"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="CommentHistory"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="SelectedPM"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="PM_List"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="GrpNames"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="mgmtIPFlag"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="equipmentFlag"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="FolderID"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="xDMSURL"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="UID"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="TechnologyArray"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="ServiceTypeArray"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="EquipmentArray"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="ServiceStatusArray"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="BandwidthArray"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="AccountTypeArray"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="BuildingFloorArray"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="BuildingIDArray"/>
                    </pageActivityParameters>
                </model:PageActivityDataModelType>
                <tibex:completedScript expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[var Log_Activity_Name=TaskName;
var Log_Activity_Type="End";
var Log_Activity_Resource="USER";
if( (infoLoggerFlag==true) && (TaskName=="GateKeeper") ){
	Log.write("[SFC_FOSIMPL_BPM] UserTask_Complete_Script_Selected_PM : "+SelectedPM);
}
else if( (infoLoggerFlag==true) && (TaskName=="GateKeeper")) {
	Log.write("[SFC_FOSIMPL_BPM] UserTask_Complete_Script_Selected_Contractor_Group :"+SelectedContractorGroup);
}]]></tibex:completedScript>
                <tibex:initiatedScript expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[var Log_Activity_Name=TaskName;
var Log_Activity_Type="Start";
var Log_Activity_Resource="USER";

if( (infoLoggerFlag==true) && (TaskName=="GateKeeper") ){
	Log.write("[SFC_FOSIMPL_BPM] UserTask_Initiate_Script_PM_List_Size :"+PM_List.size());
}
else if( (infoLoggerFlag==true) && (TaskName=="GateKeeper")) {
	Log.write("[SFC_FOSIMPL_BPM] UserTask_Initiate_Script_PM_List_Size :"+CtrGroups_List.size());
}]]></tibex:initiatedScript>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="ContractorMobileTask"
                tibex:extendedAttributes="bpmJspTask=form\://comsfcfosImplremoval_tobe_pageflow/comsfcfosImplremoval_tobe_pageflowProcess/Contractor/ManualInstallation_Remote.form&#xd;&#xa;"
                tibex:type="userTask"
                tibex:xpdlId="_gfp8oAlfEeiPXa3e9UY2HA" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="_iwMb4AlfEeiPXa3e9UY2HA to ContractorMobileTask"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="ContractorMobileTask to InsertBusinessData"/>
                </bpws:sources>
                <model:PageActivityDataModelType xmi:version="2.0"
                    xmlns:model="http://model.pageactivity.n2.tibco.com" xmlns:xmi="http://www.omg.org/XMI">
                    <pageActivityParameters>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="TechnicalInfo"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="SelectedContractor"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="TaskName"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="CommentHistory"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="SelectedContractorGroup"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="GroupNames"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="Provisioning_Data"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="ContractorNames"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="CommentText"/>
                        <pageActivityParameter mandatory="false"
                            mode="INOUT" name="xDMSURL"/>
                    </pageActivityParameters>
                </model:PageActivityDataModelType>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:empty name="_BX_gateway__iwMb4AlfEeiPXa3e9UY2HA"
            tibex:type="exclusiveGateway" tibex:xpdlId="_iwMb4AlfEeiPXa3e9UY2HA">
            <bpws:targets>
                <bpws:target linkName="ScriptTask to _iwMb4AlfEeiPXa3e9UY2HA"/>
            </bpws:targets>
            <bpws:sources tibex:maxTrue="1">
                <bpws:source linkName="_iwMb4AlfEeiPXa3e9UY2HA to ConfirmDetails">
                    <bpws:transitionCondition expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[##otherwise##]]></bpws:transitionCondition>
                </bpws:source>
                <bpws:source linkName="_iwMb4AlfEeiPXa3e9UY2HA to ContractorMobileTask">
                    <bpws:transitionCondition expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[((CtrMobileTaskDecision==true) && (TaskName=="Obtain_Customer_Confirmation"));]]></bpws:transitionCondition>
                </bpws:source>
            </bpws:sources>
        </bpws:empty>
        <bpws:scope name="InsertComment" tibex:type="reusableSubProcess" tibex:xpdlId="_MsobYBbDEei_483sJGVYzg">
            <bpws:targets>
                <bpws:target linkName="InsertBusinessData to InsertComment"/>
            </bpws:targets>
            <bpws:sources>
                <bpws:source linkName="InsertComment to EndEvent2"/>
            </bpws:sources>
            <bpws:variables>
                <bpws:variable name="_BX_CommentDataCase" tibex:class="com.sfc.fosImpl.dataModel.CommentDataCase"/>
            </bpws:variables>
            <bpws:sequence name="_BX_sequence">
                <bpws:extensionActivity>
                    <tibex:extActivity name="_BX_SPInput_InsertComment" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                        <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[// Create target 'CommentDataCase' if it doesn't exist.
if (_BX_CommentDataCase == null) {
    _BX_CommentDataCase = com_sfc_fosImpl_dataModel_Factory.createCommentDataCase();
}

// Map from 'Added By.' to 'CommentDataCase.addedby'

// Function for user defined mapping script: Added By.
function _f1_() { 
    return String((Process.getOriginatorName()));
    
}
_BX_CommentDataCase.addedby = _f1_();

// Map from 'CommentText' to 'CommentDataCase.comments'
_BX_CommentDataCase.comments = CommentText;

// Map from 'Provisioning_Data.siebelCircuitID' to 'CommentDataCase.siebelCircuitID'
if (Provisioning_Data != null) {
    _BX_CommentDataCase.siebelCircuitID = Provisioning_Data.siebelCircuitID;
} else {
    _BX_CommentDataCase.siebelCircuitID = null;
}

// Map from 'TaskName' to 'CommentDataCase.taskName'
_BX_CommentDataCase.taskName = TaskName;


]]></tibex:script>
                    </tibex:extActivity>
                </bpws:extensionActivity>
                <bpws:extensionActivity>
                    <tibex:extActivity name="InsertComment" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                        <tibex:callProcess asynch="yes" attached="no"
                            packageRef="/com.sfc.fosImpl.activation/Process Packages/com.sfc.fosImpl.removal_tobe_pageflow.xpdl"
                            remoteEngine="yes"
                            subProcessId="_9BfYMBbCEei_483sJGVYzg" version="[2.0.0,3.0.0)">
                            <tibex:subProcessInput>
                                <tibex:mapping
                                    field="_BX_CommentDataCase" formalParameter="CommentDataCase"/>
                            </tibex:subProcessInput>
                        </tibex:callProcess>
                    </tibex:extActivity>
                </bpws:extensionActivity>
            </bpws:sequence>
        </bpws:scope>
        <bpws:empty name="EndEvent2" tibex:type="endEvent" tibex:xpdlId="_YzqeoBbDEei_483sJGVYzg">
            <bpws:targets>
                <bpws:target linkName="InsertComment to EndEvent2"/>
            </bpws:targets>
        </bpws:empty>
        <bpws:extensionActivity>
            <tibex:extActivity name="LookupData" tibex:type="scriptTask"
                tibex:xpdlId="_XtZuQBbQEei5zJcabt9kCg" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="StartEvent to LookupData"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="LookupData to ScriptTask"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[var a;
var tmpTechnicalInfo = cac_com_sfc_fosImpl_bizData_dataModel_Technical_Information.findBySiebelCircuitID(Provisioning_Data.siebelCircuitID);

var copyTo = com_sfc_fosImpl_dataModel_Factory.createTechnicalInformation();
if(tmpTechnicalInfo!=null) {

var copyFrom = tmpTechnicalInfo;

copyTo.SFCPOPPE	       = 	copyFrom.readTechnical_Information().SFCPOPPE;
copyTo.aggPoint		   = 	copyFrom.readTechnical_Information().aggPoint;	
copyTo.carrierIP	   = 	copyFrom.readTechnical_Information().carrierIP;
copyTo.carrierVLAN     = 	copyFrom.readTechnical_Information().carrierVLAN;
copyTo.clientIP        = 	copyFrom.readTechnical_Information().clientIP;
copyTo.clientVLAN	   = 	copyFrom.readTechnical_Information().clientVLAN;
copyTo.modifiedBy	   = 	copyFrom.readTechnical_Information().modifiedBy; 
copyTo.modifiedDate	   = 	copyFrom.readTechnical_Information().modifiedDate;
copyTo.port			   = 	copyFrom.readTechnical_Information().port;		
copyTo.portType		   = 	copyFrom.readTechnical_Information().portType;	
//copyTo.siebelCircuitID = 	copyFrom.readTechnical_Information().siebelCircuitID;


for(var i=0;i<copyFrom.readTechnical_Information().equipment.size();i++) {
	var equipments  = com_sfc_fosImpl_dataModel_Factory.createEquipmentDetails();
	
	equipments.VLAN	= copyFrom.readTechnical_Information().equipment.get(i).VLAN;
	equipments.address	= copyFrom.readTechnical_Information().equipment.get(i).address;
	equipments.type	= copyFrom.readTechnical_Information().equipment.get(i).type;
	copyTo.equipment.add(equipments);	
}


TechnicalInfo = ScriptUtil.copy(copyTo);
}
else {

}




]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:scope name="InsertBusinessData"
            tibex:type="reusableSubProcess" tibex:xpdlId="_UWEwoRbREei5zJcabt9kCg">
            <tibex:initiatedScript expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[if((TaskName=="TES_OSG_Verification") || (TaskName=="Provision_Management_IP") || (TaskName=="Provision_IPs")) {
	
	TechnicalInfo.modifiedDate = DateTimeUtil.createDate();
	TechnicalInfo.modifiedBy   = Process.getOriginatorName();
	
}







]]></tibex:initiatedScript>
            <bpws:targets>
                <bpws:target linkName="ConfirmDetails to InsertBusinessData"/>
                <bpws:target linkName="ContractorMobileTask to InsertBusinessData"/>
            </bpws:targets>
            <bpws:sources>
                <bpws:source linkName="InsertBusinessData to InsertComment"/>
            </bpws:sources>
            <bpws:variables>
                <bpws:variable name="_BX_TechnicalInfomation" tibex:class="com.sfc.fosImpl.dataModel.TechnicalInformation"/>
                <bpws:variable name="_BX_ProvisoningData" tibex:class="com.sfc.fosImpl.dataModel.ProvisioningDataModel"/>
            </bpws:variables>
            <bpws:sequence name="_BX_sequence_2">
                <bpws:extensionActivity>
                    <tibex:extActivity
                        name="_BX_SPInput_InsertBusinessData" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                        <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[// Map from 'Provisioning_Data' to 'ProvisoningData'
_BX_ProvisoningData = ScriptUtil.copy(Provisioning_Data);

// Map from 'TechnicalInfo' to 'TechnicalInfomation'
_BX_TechnicalInfomation = ScriptUtil.copy(TechnicalInfo);


]]></tibex:script>
                    </tibex:extActivity>
                </bpws:extensionActivity>
                <bpws:extensionActivity>
                    <tibex:extActivity name="InsertBusinessData" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                        <tibex:callProcess followParentLifecycle="yes"
                            priority="inline" subProcessId="_F34bABbMEei5zJcabt9kCg">
                            <tibex:subProcessInput>
                                <tibex:mapping
                                    field="_BX_TechnicalInfomation" formalParameter="TechnicalInfomation"/>
                                <tibex:mapping
                                    field="_BX_ProvisoningData" formalParameter="ProvisoningData"/>
                            </tibex:subProcessInput>
                        </tibex:callProcess>
                    </tibex:extActivity>
                </bpws:extensionActivity>
            </bpws:sequence>
        </bpws:scope>
        <bpws:extensionActivity>
            <tibex:extActivity name="ScriptTask" tibex:type="scriptTask"
                tibex:xpdlId="_BKqycCNYEeiHXsndwsqKDg" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="LookupData to ScriptTask"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="ScriptTask to _iwMb4AlfEeiPXa3e9UY2HA"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[var criteria = "enableFlag='Y' AND lookupKey='ACCOUNT_TYPE'";

LookupDataAccountTypeRef=cac_com_sfc_fosImpl_dataModel_LookupTable.findByCriteria(criteria);
for(var index=0; index<LookupDataAccountTypeRef.size(); index++) {
AccountTypeArray.add(LookupDataAccountTypeRef.get(index).readLookupTable().lookupValue);	
}
var criteria = "enableFlag='Y' AND lookupKey='SERVICE_TYPE'";

LookupDataServiceTypeRef=cac_com_sfc_fosImpl_dataModel_LookupTable.findByCriteria(criteria);
for(var index=0; index<LookupDataServiceTypeRef.size(); index++) {
ServiceTypeArray.add(LookupDataServiceTypeRef.get(index).readLookupTable().lookupValue);	
}
var criteria = "enableFlag='Y' AND lookupKey='BANDWIDTH_TYPE'";

LookupDataBandwidthRef=cac_com_sfc_fosImpl_dataModel_LookupTable.findByCriteria(criteria);
for(var index=0; index<LookupDataBandwidthRef.size(); index++) {
BandwidthArray.add(LookupDataBandwidthRef.get(index).readLookupTable().lookupValue);	
}
var criteria = "enableFlag='Y' AND lookupKey='SERVICE_STATUS'";

LookupDataServiceStatusRef=cac_com_sfc_fosImpl_dataModel_LookupTable.findByCriteria(criteria);
for(var index=0; index<LookupDataServiceStatusRef.size(); index++) {
ServiceStatusArray.add(LookupDataServiceStatusRef.get(index).readLookupTable().lookupValue);	
}
var criteria = "enableFlag='Y' AND lookupKey='TECHNOLOGY_TYPE'";

LookupDataTechnologyRef=cac_com_sfc_fosImpl_dataModel_LookupTable.findByCriteria(criteria);
for(var index=0; index<LookupDataTechnologyRef.size(); index++) {
TechnologyArray.add(LookupDataTechnologyRef.get(index).readLookupTable().lookupValue);	
}
var criteria = "enableFlag='Y' AND lookupKey='EQUIPMENT_TYPE'";

LookupDataEquipmentTypeRef=cac_com_sfc_fosImpl_dataModel_LookupTable.findByCriteria(criteria);
for(var index=0; index<LookupDataEquipmentTypeRef.size(); index++) {
EquipmentArray.add(LookupDataEquipmentTypeRef.get(index).readLookupTable().lookupValue);	
}
var criteria = "enableFlag='Y' AND lookupKey='BUILDING_ID_TYPE'";

LookupDataBuildingIDRef=cac_com_sfc_fosImpl_dataModel_LookupTable.findByCriteria(criteria);
for(var index=0; index<LookupDataBuildingIDRef.size(); index++) {
BuildingIDArray.add(LookupDataBuildingIDRef.get(index).readLookupTable().lookupValue);	
}
var criteria = "enableFlag='Y' AND lookupKey='BUILDING_FLOOR_TYPE'";

LookupDataFloorRef=cac_com_sfc_fosImpl_dataModel_LookupTable.findByCriteria(criteria);
for(var index=0; index<LookupDataFloorRef.size(); index++) {
BuildingFloorArray.add(LookupDataFloorRef.get(index).readLookupTable().lookupValue);	
}]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
    </bpws:flow>
</bpws:process>
