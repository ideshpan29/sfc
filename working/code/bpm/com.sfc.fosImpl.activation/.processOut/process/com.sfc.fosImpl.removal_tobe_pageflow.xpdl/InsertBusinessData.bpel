<?xml version="1.0" encoding="UTF-8"?>
<bpws:process exitOnStandardFault="no" name="InsertBusinessData"
    suppressJoinFailure="yes" tibex:bxVersion="1.15.0"
    tibex:explicitCompensation="yes" tibex:serviceProcess="yes"
    tibex:xpdlId="_F34bABbMEei5zJcabt9kCg"
    xmlns:bpws="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
    xmlns:tibex="http://www.tibco.com/bpel/2007/extensions" xmlns:xsd="http://www.w3.org/2001/XMLSchema">
    <tibex:VariableDescriptor type="PersistentBatching">
        <task name="UpdateTechnicalInformation">
            <startingVariables>
                <variable>Technical_InformationRef</variable>
                <variable>Technical_Information</variable>
            </startingVariables>
        </task>
        <task name="Start">
            <ProcessManagerScript type="Complete">
                <variable>TechnicalInfomation</variable>
                <variable>technicalInfoInsertFlag</variable>
                <variable>ProvisoningData</variable>
                <variable>Technical_InformationRef</variable>
                <variable>Technical_Information</variable>
            </ProcessManagerScript>
            <ProcessManagerScript type="Complete">
                <variable>TechnicalInfomation</variable>
                <variable>technicalInfoInsertFlag</variable>
                <variable>ProvisoningData</variable>
                <variable>Technical_InformationRef</variable>
                <variable>Technical_Information</variable>
            </ProcessManagerScript>
        </task>
        <task name="InsertTechnicalInformation">
            <startingVariables>
                <variable>Technical_InformationRef</variable>
                <variable>Technical_Information</variable>
            </startingVariables>
        </task>
    </tibex:VariableDescriptor>
    <bpws:documentation>*** Generated by TIBCO Business Studio.</bpws:documentation>
    <bpws:variables>
        <bpws:variable name="TechnicalInfomation"
            tibex:class="com.sfc.fosImpl.dataModel.TechnicalInformation"
            tibex:parameter="inout" tibex:xpdlId="_S0kT4BbMEei5zJcabt9kCg"/>
        <bpws:variable name="ProvisoningData"
            tibex:class="com.sfc.fosImpl.dataModel.ProvisioningDataModel"
            tibex:parameter="inout" tibex:xpdlId="_zrjGEBbOEei5zJcabt9kCg"/>
        <bpws:variable name="Technical_Information"
            tibex:class="com.sfc.fosImpl.bizData.dataModel.Technical_Information" tibex:xpdlId="_XLOyIBbMEei5zJcabt9kCg"/>
        <bpws:variable name="Technical_InformationRef"
            tibex:classRef="com.sfc.fosImpl.bizData.dataModel.Technical_Information" tibex:xpdlId="_ZhmMkBbMEei5zJcabt9kCg"/>
        <bpws:variable name="technicalInfoInsertFlag"
            tibex:xpdlId="_vC8t0BbPEei5zJcabt9kCg" type="xsd:boolean"/>
    </bpws:variables>
    <bpws:extensions>
        <bpws:extension mustUnderstand="yes" namespace="http://www.tibco.com/bpel/2007/extensions"/>
    </bpws:extensions>
    <bpws:eventHandlers/>
    <bpws:flow name="_BX_flow_StP8wCXnEeiVIr-c0HRmlw">
        <bpws:links>
            <bpws:link
                name="_8wYuMBbPEei5zJcabt9kCg to InsertTechnicalInformation" tibex:xpdlId="__lQCgBbPEei5zJcabt9kCg"/>
            <bpws:link
                name="_8wYuMBbPEei5zJcabt9kCg to UpdateTechnicalInformation" tibex:xpdlId="_GKQnoBbQEei5zJcabt9kCg"/>
            <bpws:link name="UpdateTechnicalInformation to End" tibex:xpdlId="_Jjo-QBbQEei5zJcabt9kCg"/>
            <bpws:link name="Start to _8wYuMBbPEei5zJcabt9kCg" tibex:xpdlId="_8wYuMRbPEei5zJcabt9kCg"/>
            <bpws:link name="InsertTechnicalInformation to End" tibex:xpdlId="_F4jJZBbMEei5zJcabt9kCg"/>
        </bpws:links>
        <bpws:extensionActivity>
            <tibex:receiveEvent createInstance="yes" eventTimeout="0"
                name="Start" tibex:type="startEvent"
                tibex:xpdlId="_F4jJYBbMEei5zJcabt9kCg" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:sources>
                    <bpws:source linkName="Start to _8wYuMBbPEei5zJcabt9kCg"/>
                </bpws:sources>
                <tibex:completedScript expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[var copyTo = com_sfc_fosImpl_bizData_dataModel_Factory.createTechnical_Information();
var copyFrom = TechnicalInfomation;
Technical_InformationRef = cac_com_sfc_fosImpl_bizData_dataModel_Technical_Information.findBySiebelCircuitID(ProvisoningData.siebelCircuitID);


copyTo.SFCPOPPE	       = 	copyFrom.SFCPOPPE;
copyTo.aggPoint		   = 	copyFrom.aggPoint;	
copyTo.carrierIP	   = 	copyFrom.carrierIP;
copyTo.carrierVLAN     = 	copyFrom.carrierVLAN;
copyTo.clientIP        = 	copyFrom.clientIP;
copyTo.clientVLAN	   = 	copyFrom.clientVLAN;
copyTo.modifiedBy	   = 	copyFrom.modifiedBy; 
copyTo.modifiedDate	   = 	copyFrom.modifiedDate;
copyTo.port			   = 	copyFrom.port;		
copyTo.portType		   = 	copyFrom.portType;	
copyTo.siebelCircuitID = 	ProvisoningData.siebelCircuitID;

for(var i=0;i<copyFrom.equipment.size();i++) {
	var equipments  = com_sfc_fosImpl_bizData_dataModel_Factory.createEquipment_Details();
	equipments.VLAN	= copyFrom.equipment.get(i).VLAN;
	equipments.address	= copyFrom.equipment.get(i).address;
	equipments.type	= copyFrom.equipment.get(i).type;
	copyTo.equipment.add(equipments);	
}

var tmpTechnicalInfo = cac_com_sfc_fosImpl_bizData_dataModel_Technical_Information.findBySiebelCircuitID(ProvisoningData.siebelCircuitID);
if(tmpTechnicalInfo==null) {
	technicalInfoInsertFlag = true;
}
else {
	technicalInfoInsertFlag = false;
}
Technical_Information=ScriptUtil.copy(copyTo);
	    
   
	    
	    
	    
]]></tibex:completedScript>
                <tibex:parameters>
                    <parameterDescription mode="InOut" name="TechnicalInfomation"/>
                    <parameterDescription mode="InOut" name="ProvisoningData"/>
                </tibex:parameters>
                <tibex:completedScript
                    expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions"><![CDATA[var copyTo = com_sfc_fosImpl_bizData_dataModel_Factory.createTechnical_Information();
var copyFrom = TechnicalInfomation;
Technical_InformationRef = cac_com_sfc_fosImpl_bizData_dataModel_Technical_Information.findBySiebelCircuitID(ProvisoningData.siebelCircuitID);


copyTo.SFCPOPPE	       = 	copyFrom.SFCPOPPE;
copyTo.aggPoint		   = 	copyFrom.aggPoint;	
copyTo.carrierIP	   = 	copyFrom.carrierIP;
copyTo.carrierVLAN     = 	copyFrom.carrierVLAN;
copyTo.clientIP        = 	copyFrom.clientIP;
copyTo.clientVLAN	   = 	copyFrom.clientVLAN;
copyTo.modifiedBy	   = 	copyFrom.modifiedBy; 
copyTo.modifiedDate	   = 	copyFrom.modifiedDate;
copyTo.port			   = 	copyFrom.port;		
copyTo.portType		   = 	copyFrom.portType;	
copyTo.siebelCircuitID = 	ProvisoningData.siebelCircuitID;

for(var i=0;i<copyFrom.equipment.size();i++) {
	var equipments  = com_sfc_fosImpl_bizData_dataModel_Factory.createEquipment_Details();
	equipments.VLAN	= copyFrom.equipment.get(i).VLAN;
	equipments.address	= copyFrom.equipment.get(i).address;
	equipments.type	= copyFrom.equipment.get(i).type;
	copyTo.equipment.add(equipments);	
}

var tmpTechnicalInfo = cac_com_sfc_fosImpl_bizData_dataModel_Technical_Information.findBySiebelCircuitID(ProvisoningData.siebelCircuitID);
if(tmpTechnicalInfo==null) {
	technicalInfoInsertFlag = true;
}
else {
	technicalInfoInsertFlag = false;
}
Technical_Information=ScriptUtil.copy(copyTo);
	    
   
	    
	    
	    
]]></tibex:completedScript>
                <tibex:eventSource>
                    <tibex:startEvent eventType="Default"/>
                </tibex:eventSource>
            </tibex:receiveEvent>
        </bpws:extensionActivity>
        <bpws:empty name="End" tibex:migrationAllowed="yes"
            tibex:type="endEvent" tibex:xpdlId="_F4jJYRbMEei5zJcabt9kCg">
            <bpws:targets>
                <bpws:target linkName="UpdateTechnicalInformation to End"/>
                <bpws:target linkName="InsertTechnicalInformation to End"/>
            </bpws:targets>
        </bpws:empty>
        <bpws:empty name="_BX_gateway__8wYuMBbPEei5zJcabt9kCg"
            tibex:type="exclusiveGateway" tibex:xpdlId="_8wYuMBbPEei5zJcabt9kCg">
            <bpws:targets>
                <bpws:target linkName="Start to _8wYuMBbPEei5zJcabt9kCg"/>
            </bpws:targets>
            <bpws:sources tibex:maxTrue="1">
                <bpws:source linkName="_8wYuMBbPEei5zJcabt9kCg to InsertTechnicalInformation">
                    <bpws:transitionCondition expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[(technicalInfoInsertFlag==true);]]></bpws:transitionCondition>
                </bpws:source>
                <bpws:source linkName="_8wYuMBbPEei5zJcabt9kCg to UpdateTechnicalInformation">
                    <bpws:transitionCondition expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[##otherwise##]]></bpws:transitionCondition>
                </bpws:source>
            </bpws:sources>
        </bpws:empty>
        <bpws:extensionActivity>
            <tibex:extActivity name="InsertTechnicalInformation"
                tibex:migrationAllowed="yes" tibex:type="serviceTask"
                tibex:xpdlId="__lPbcBbPEei5zJcabt9kCg" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="_8wYuMBbPEei5zJcabt9kCg to InsertTechnicalInformation"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="InsertTechnicalInformation to End"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[Technical_InformationRef = cac_com_sfc_fosImpl_bizData_dataModel_Technical_Information.create(Technical_Information);]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
        <bpws:extensionActivity>
            <tibex:extActivity name="UpdateTechnicalInformation"
                tibex:migrationAllowed="yes" tibex:type="serviceTask"
                tibex:xpdlId="_EdBpwBbQEei5zJcabt9kCg" xmlns:tibex="http://www.tibco.com/bpel/2007/extensions">
                <bpws:targets>
                    <bpws:target linkName="_8wYuMBbPEei5zJcabt9kCg to UpdateTechnicalInformation"/>
                </bpws:targets>
                <bpws:sources>
                    <bpws:source linkName="UpdateTechnicalInformation to End"/>
                </bpws:sources>
                <tibex:script expressionLanguage="urn:tibco:wsbpel:2.0:sublang:javascript"><![CDATA[Technical_InformationRef.updateTechnical_Information(Technical_Information);]]></tibex:script>
            </tibex:extActivity>
        </bpws:extensionActivity>
    </bpws:flow>
</bpws:process>
